import { Component, OnInit } from '@angular/core';
import { ActivatedRoute } from '@angular/router';
import { StoryService } from '../../../services/story';

@Component({
  selector: 'app-my-profile',
  templateUrl: './my-profile.component.html',
  styleUrls: ['./my-profile.component.css']
})
export class MyProfileComponent implements OnInit {
	uid: string; //user's id from local storage
	storyKey: any; //the key generated by firebase for each item
	story: object; //the story the user clicked on
	imgObj;
	imgUrl: object[] = []; //store a list of image urls for this story

  constructor(private storyService: StoryService,
  						private routeParams: ActivatedRoute) { 
  	this.uid = JSON.parse(localStorage.getItem('currentUser')).uid;

  	let currentStory = this.routeParams.params.subscribe((data) => {
			this.storyKey = data.key;
  	});
  }

  ngOnInit() {
  	// this.storyService.getStory(this.uid, this.storyKey).subscribe((story) => {
  	// 	this.story = story
  	// 	console.log(this.story);
  	
  	// 	for (let property in story) {
		 //    if (story.hasOwnProperty('images')) {	      
		 //        this.imgObj = story.images;
		
		 //    } else {
		 //    	console.log('no images');
		 //    }
			// }//for 
			// if(this.imgObj > 0) {
			// 	 for(let img in this.imgObj) {
		 //        	// console.log(this.imgObj[img].url);
		 //        	if(this.imgObj[img].url) {
		 //        		this.imgUrl.push(this.imgObj[img].url);
		 //        	}
		 //        }
		 //        console.log(this.imgUrl);
			// }
			// console.log(this.imgObj); 		
  	// })
  	this.storyService.getUrl(this.uid, this.storyKey).subscribe((storyImages) => {
  		console.log(storyImages);
  		this.imgUrl = storyImages;
  	})
  }

}
